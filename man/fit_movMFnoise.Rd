% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em_movMF.R
\name{fit_movMFnoise}
\alias{fit_movMFnoise}
\title{Fit Mixture of von Mises-Fisher Distributions with Automatic Model Selection}
\usage{
fit_movMFnoise(
  x,
  G = NULL,
  noise = FALSE,
  control = control_movMFnoise(),
  verbose = FALSE,
  criterion = c("bic", "icl"),
  keep_all = FALSE
)
}
\arguments{
\item{x}{Data matrix (n x d) where each row is a unit vector on the hypersphere}

\item{G}{Vector of integers specifying the number of mixture components to try.
If NULL (default), tries G = 1:9}

\item{noise}{Logical or character vector; if TRUE, fits models with a uniform noise
component. If FALSE (default), fits models without noise. If c(TRUE, FALSE),
tries both options for each G and selects best overall model.}

\item{control}{List of control parameters. See \code{\link{control_movMFnoise}} for details.
Default values are obtained by calling \code{control_movMFnoise()}.}

\item{verbose}{Logical; if TRUE, print progress information (default: FALSE)}

\item{criterion}{Character; model selection criterion, either "bic" (default) or "icl"}

\item{keep_all}{Logical; if TRUE, all fitted models are returned in the output (default: FALSE)}
}
\value{
A list with class "movMFnoise" containing the best model, plus additional components:
\item{G_sequence}{Vector of G values tried}
\item{noise_sequence}{Logical vector indicating which models included noise}
\item{bic_all}{Vector of BIC values for all fitted models}
\item{icl_all}{Vector of ICL values for all fitted models}
\item{loglik_all}{Vector of log-likelihood values for all fitted models}
\item{all_models}{List of all fitted models (optional, only if keep_all = TRUE)}
\item{best_G}{Optimal number of components (excluding noise)}
\item{best_noise}{Whether the best model includes noise}
}
\description{
Wrapper function that fits mixture of von Mises-Fisher distributions for
multiple values of G (number of components) and selects the best model
according to BIC, similar to \code{mclust::Mclust()}. The main functionality
includes the optional addition of a uniform noise component to handle
outliers and observations that do not belong to any cluster.
}
\details{
This function fits movMF models for each combination of G values and noise options,
then selects the model with the best (highest) BIC or ICL value. This follows the
approach used by \code{mclust::Mclust()} for Gaussian mixtures, where higher values
of BIC and ICL indicate better models.

The function returns the best model along with summary information about all
fitted models for comparison purposes.
}
\examples{
\dontrun{
# Generate example data
set.seed(123)
x <- movMF::rmovMF(100, theta = rbind(c(5, 0, 0), c(0, 5, 0)))

# Automatic model selection
fit <- fit_movMFnoise(x, G = 1:5)
print(fit)
summary(fit)

# Try both with and without noise
fit <- fit_movMFnoise(x, G = 1:5, noise = c(FALSE, TRUE))

# Compare all models
plot(fit$G_sequence, fit$bic_all, type = "b", xlab = "G", ylab = "BIC")
}
}
\seealso{
\code{\link{em_movMF}}, \code{\link{control_movMFnoise}}
}
